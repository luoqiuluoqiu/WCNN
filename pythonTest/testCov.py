# -*- coding: utf-8 -*-

# @Time    : 2019/3/19 17:56
# @Author  : WYJ
# @Email   : 1054469230@qq.com
# @File    : test.py
# @Software: PyCharm
# @version : 3.6
# @Function: 

import os
import sys

if sys.version[0] == "2":
    reload(sys)
    sys.setdefaultencoding("utf-8")

import torch
from torch.nn import functional as F

filters=torch.Tensor([[[[ 0.2939, -0.1639, -0.9099],
          [-0.0662,  0.6573,  1.0217],
          [ 0.5235, -1.1140,  0.3504]],

         [[-1.2583,  0.4282,  0.0435],
          [ 1.3338, -0.9523, -0.3468],
          [-0.5925,  0.1982, -0.1812]]],


        [[[ 2.0044, -0.2663, -0.0913],
          [ 0.3553, -0.6623, -0.4073],
          [-1.0647, -0.6308, -0.3822]],

         [[ 1.8922, -1.2378,  0.7259],
          [-0.5025, -1.0041,  2.5327],
          [ 0.2835,  0.4321, -0.8296]]],


        [[[-2.4078, -0.0111,  0.0992],
          [-0.3758, -1.5001, -0.5062],
          [-0.8001,  1.8466,  0.7307]],

         [[-1.0821, -0.6087, -0.9051],
          [ 1.4373,  2.0768, -0.9805],
          [ 0.3215, -0.0536,  1.4021]]],


        [[[-0.2429, -0.7302,  0.3869],
          [ 0.1547,  2.4416, -1.8130],
          [-1.2256, -0.1704, -0.9374]],

         [[ 0.0250,  0.7704, -0.8758],
          [ 1.1362,  1.0234, -0.7100],
          [-0.6157, -1.7720,  0.2216]]]])

inputs = torch.Tensor([[[[-5.5206e-01, -1.3327e+00, -9.6631e-01,  1.3685e+00, -4.1081e-01],
          [ 6.5883e-01,  1.7206e-01, -2.6127e-01,  1.5243e+00, -1.0075e+00],
          [ 1.1112e+00,  1.2595e+00, -1.6282e-01, -5.1200e-01, -1.7343e-01],
          [-2.7124e-01,  1.3276e+00,  6.3410e-01,  1.3554e+00, -7.6201e-02],
          [-1.9538e-03,  6.9230e-01,  1.2193e+00,  7.7638e-01,  8.5696e-01]],

         [[-7.8446e-02,  7.2267e-01, -7.0697e-01, -8.2278e-01,  2.8154e-01],
          [-2.2324e+00,  1.7611e-01, -9.4444e-01, -1.2315e+00,  3.7315e-01],
          [-1.7369e+00,  6.2123e-01, -1.3330e+00, -7.9458e-01, -2.4785e-01],
          [-4.8617e-01,  4.4016e-01, -2.1703e+00,  2.5121e-01, -6.2328e-02],
          [ 1.3065e+00, -2.0849e+00, -5.1301e-02, -9.3929e-01,  1.0895e+00]],

         [[ 2.7805e-01, -4.1970e-01,  2.4863e+00, -2.9015e+00,  8.1118e-01],
          [ 1.0164e+00,  2.4565e-01,  1.3769e-01, -2.6734e-01,  4.7465e-01],
          [ 1.3503e+00,  1.5392e+00,  1.3353e+00, -8.0135e-01, -4.4794e-01],
          [-1.5889e-01,  3.1288e-01,  1.1469e+00,  1.7620e-01, -1.2321e-02],
          [ 3.1716e-01,  5.9338e-01, -1.3817e+00,  2.6376e-01, -1.0761e+00]],

         [[ 4.8384e-01, -1.3983e-01,  1.9736e+00, -1.7423e-01, -2.5046e-01],
          [ 1.6751e-01,  9.8185e-01, -2.1264e-01,  4.1853e-01, -1.5432e-01],
          [-5.5043e-01, -2.8385e+00,  1.5255e-01, -6.9478e-01, -1.8211e+00],
          [ 1.9278e+00,  7.7455e-01,  7.3442e-01, -1.4730e+00, -8.5779e-01],
          [ 1.1854e-01,  1.4436e+00, -7.0385e-01,  1.3248e+00, -2.5469e+00]]]])
bias= torch.Tensor([ 0.6045,  0.4045, -1.5431,  0.3637])
a=F.conv2d(inputs, filters, padding=2,stride=2,dilation=2,groups=2,bias=bias)
print(a.size())
print(a)